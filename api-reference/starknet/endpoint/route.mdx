---
title: 'Route'
description: 'Find optimal route for a token swap through Fibrous Finance on Starknet'
api: 'GET /starknet/route'

---

<CodeGroup>
```bash
https://api.fibrous.finance/starknet/route
```
</CodeGroup>

Find the optimal trading route for a token swap through Fibrous Finance's liquidity pools on Starknet. This endpoint analyzes multiple protocols, pool depths, and potential paths to deliver the most efficient swap execution for your tokens.

## Query Parameters

<ParamField query="amount" type="string" required>
  Input token amount in wei format. For tokens with 18 decimals, multiply the amount by 10^18.
  
  Example: `"1000000000000000000"` (1 ETH)
</ParamField>

<ParamField query="tokenInAddress" type="string" required>
  Input token address.
  
  Example: `"0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7"` (ETH)
</ParamField>

<ParamField query="tokenOutAddress" type="string" required>
  Output token address.
  
  Example: `"0x068f5c6a61780768455de69077e07e89787839bf8166decfbf92b645209c0fb8"` (USDC)
</ParamField>

<ParamField query="reverse" type="boolean">
  If true, the amount parameter represents the desired output amount instead of input amount.
  
  Default: `false`
</ParamField>

<ParamField query="direct" type="boolean">
  If true, only direct swaps between the input and output tokens will be considered.
  
  Default: `false`
</ParamField>

<ParamField query="excludeProtocols" type="array[string]">
  Array of protocol names to exclude from routing.
  
  Example: `["JediSwap", "10kSwap"]`
</ParamField>

## Response

<ResponseField name="success" type="boolean">
  Indicates if the request was successful.
</ResponseField>

<ResponseField name="inputToken" type="object">
  Details about the input token
  <Expandable>
    <ResponseField name="name" type="string">Token name</ResponseField>
    <ResponseField name="address" type="string">Token contract address</ResponseField>
    <ResponseField name="decimals" type="number">Token decimals</ResponseField>
    <ResponseField name="price" type="number">Current token price in USD</ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="outputToken" type="object">
  Details about the output token
  <Expandable>
    <ResponseField name="name" type="string">Token name</ResponseField>
    <ResponseField name="address" type="string">Token contract address</ResponseField>
    <ResponseField name="decimals" type="number">Token decimals</ResponseField>
    <ResponseField name="price" type="number">Current token price in USD</ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="route" type="array">
  Array of route segments, each containing:
  <Expandable>
    <ResponseField name="percent" type="string">Percentage of total amount routed through this segment</ResponseField>
    <ResponseField name="swaps" type="array">
      Array of swap steps in this segment
      <Expandable>
        <ResponseField name="protocol" type="number">Protocol identifier</ResponseField>
        <ResponseField name="poolName" type="string">Name of the liquidity pool</ResponseField>
        <ResponseField name="poolAddress" type="string">Address of the liquidity pool</ResponseField>
        <ResponseField name="percent" type="string">Percentage of segment amount routed through this pool</ResponseField>
        <ResponseField name="extraData" type="object">Additional protocol-specific data</ResponseField>
      </Expandable>
    </ResponseField>
  </Expandable>
</ResponseField>

<ResponseField name="time" type="number">
  Time taken to find the route in seconds
</ResponseField>

<ResponseField name="estimatedGasUsed" type="string">
  Estimated gas that will be used for the swap
</ResponseField>

<ResponseField name="estimatedGasUsedInUsd" type="number">
  Estimated gas cost in USD
</ResponseField>

<RequestExample>
```bash cURL
curl -L \
  "https://api.fibrous.finance/starknet/route?amount=1000000000000000000&tokenInAddress=0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7&tokenOutAddress=0x068f5c6a61780768455de69077e07e89787839bf8166decfbf92b645209c0fb8" \
  --header "Accept: */*"
```

```python Python
import requests

url = "https://api.fibrous.finance/starknet/route"

params = {
    "amount": "1000000000000000000",  # 1 ETH
    "tokenInAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
    "tokenOutAddress": "0x068f5c6a61780768455de69077e07e89787839bf8166decfbf92b645209c0fb8"
}

response = requests.get(url, params=params)
print(response.json())
```

```javascript JavaScript
const axios = require('axios');

const params = {
  amount: '1000000000000000000', // 1 ETH
  tokenInAddress: '0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7',
  tokenOutAddress: '0x068f5c6a61780768455de69077e07e89787839bf8166decfbf92b645209c0fb8'
};

axios.get('https://api.fibrous.finance/starknet/route', { params })
  .then(response => console.log(response.data))
  .catch(error => console.error(error));
```
</RequestExample>

<ResponseExample>
```json Response
{
  "success": true,
  "routeId": "b4a3c7ec-cc7a-4911-8271-3bbc0fd0f74c",
  "inputToken": {
    "address": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
    "name": "Ether",
    "symbol": "ETH",
    "decimals": 18,
    "base": true,
    "native": true,
    "price": "4334.93"
  },
  "inputAmount": "1000000000000000000",
  "outputToken": {
    "address": "0x068f5c6a61780768455de69077e07e89787839bf8166decfbf92b645209c0fb8",
    "name": "Tether USD",
    "symbol": "USDT",
    "decimals": 6,
    "base": true,
    "native": false,
    "price": "1"
  },
  "outputAmount": "4294604326",
  "time": 2.228,
  "estimatedGasUsed": "452175251237519300",
  "estimatedGasUsedInUsd": 0.054666630760995635,
  "route": [
    {
      "percent": "97%",
      "swaps": [
        [
          {
            "protocol": 5,
            "poolId": "5:0x00000005dd3d2f4429af886cd1a3b08289dbcea99a294197e9eb43b0e0325b4b:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8:0xc25669ed8b70551736c7833dc0fde2d93d7829df3c0969aaadc642a36d4c98",
            "poolName": "Ekubo",
            "poolAddress": "0x00000005dd3d2f4429af886cd1a3b08289dbcea99a294197e9eb43b0e0325b4b",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "74.00%",
            "tick_spacing": 1000,
            "fee": "0x20c49ba5e353f80000000000000000",
            "liquidity": "18192943774893943",
            "sqrt_price": "22339850386733508665161426074672526",
            "pool_key": "0xc25669ed8b70551736c7833dc0fde2d93d7829df3c0969aaadc642a36d4c98",
            "extraData": {
              "extension": "0x0000000000000000000000000000000000000000000000000000000000000000"
            }
          },
          {
            "protocol": 5,
            "poolId": "5:0x00000005dd3d2f4429af886cd1a3b08289dbcea99a294197e9eb43b0e0325b4b:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8:0x0305a929dfbafeb094fe63430e7f14f9b43a86b29831e3f21088e345ee145d91",
            "poolName": "Ekubo",
            "poolAddress": "0x00000005dd3d2f4429af886cd1a3b08289dbcea99a294197e9eb43b0e0325b4b",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "5.00%",
            "tick_spacing": 5982,
            "fee": "0xc49ba5e353f7d00000000000000000",
            "liquidity": "2225131020847155",
            "sqrt_price": "22340544698589647251040986459872528",
            "pool_key": "0x0305a929dfbafeb094fe63430e7f14f9b43a86b29831e3f21088e345ee145d91",
            "extraData": {
              "extension": "0x0000000000000000000000000000000000000000000000000000000000000000"
            }
          },
          {
            "protocol": 9,
            "poolId": "9:0x05e03162008d76cf645fe53c6c13a7a5fce745e8991c6ffe94400d60e44c210a:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "poolName": "NostraStable",
            "poolAddress": "0x05e03162008d76cf645fe53c6c13a7a5fce745e8991c6ffe94400d60e44c210a",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "3.00%",
            "fee": "5000000000000000",
            "extraData": {
              "rate_provider1": "0x05a1b2a3cdd0615a706239804e990af3f07b7fb9ba16cef11fac1552059912b9",
              "rate_provider2": "0x04d94a9b86d12e61351865c0c1cf7ad8aaa02f45fc6dfddc54869b5de6705e87",
              "amp_start": 25,
              "amp_end": 100,
              "rate1": "4303769280270000000000",
              "rate2": "1000000000000000000000000000000"
            }
          },
          {
            "protocol": 2,
            "poolId": "2:0x04d0390b777b424e43839cd1e744799f3de6c176c7e32c1812a41dbd9c19db6a:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "poolName": "JediSwap",
            "poolAddress": "0x04d0390b777b424e43839cd1e744799f3de6c176c7e32c1812a41dbd9c19db6a",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "10.00%",
            "fee": "0.3",
            "extraData": {}
          },
          {
            "protocol": 9,
            "poolId": "9:0x05ef8800d242c5d5e218605d6a10e81449529d4144185f95bf4b8fb669424516:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "poolName": "NostraV2",
            "poolAddress": "0x05ef8800d242c5d5e218605d6a10e81449529d4144185f95bf4b8fb669424516",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "1.00%",
            "fee": "0xa",
            "extraData": {}
          },
          {
            "protocol": 6,
            "poolId": "6:0x01114c7103e12c2b2ecbd3a2472ba9c48ddcbf702b1c242dd570057e26212111:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8:0x071273c5c5780b4be42d9e6567b1b1a6934f43ab8abaf975c0c3da219fc4d040",
            "poolName": "MyswapCL",
            "poolAddress": "0x01114c7103e12c2b2ecbd3a2472ba9c48ddcbf702b1c242dd570057e26212111",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "6.00%",
            "tick_spacing": 10,
            "fee": "0x1f4",
            "liquidity": "1836583108654633",
            "sqrt_price": "5199069779344232716823037",
            "pool_key": "0x071273c5c5780b4be42d9e6567b1b1a6934f43ab8abaf975c0c3da219fc4d040",
            "extraData": {}
          },
          {
            "protocol": 6,
            "poolId": "6:0x01114c7103e12c2b2ecbd3a2472ba9c48ddcbf702b1c242dd570057e26212111:0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7:0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8:0x018040da4516869bb63f1578b81bf2a7336977b08fb2941de556ca8726913129",
            "poolName": "MyswapCL",
            "poolAddress": "0x01114c7103e12c2b2ecbd3a2472ba9c48ddcbf702b1c242dd570057e26212111",
            "fromTokenAddress": "0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7",
            "toTokenAddress": "0x053c91253bc9682c04929ca02ed00b3e423f6710d2ee7e0d5ebb06f3ecf368a8",
            "percent": "1.00%",
            "tick_spacing": 60,
            "fee": "0xbb8",
            "liquidity": "179539876650193",
            "sqrt_price": "5205773804419241142396309",
            "pool_key": "0x018040da4516869bb63f1578b81bf2a7336977b08fb2941de556ca8726913129",
            "extraData": {}
          }
        ]
      ]
    }
  ],
  "bestQuotesByProtocols": [
    {"name": "", "quote": "", "quoteGasAdjusted": ""},
    {"name": "", "quote": "", "quoteGasAdjusted": ""},
    {"name": "", "quote": "", "quoteGasAdjusted": ""}
  ],
  "initial": false
}
```
</ResponseExample>

